import {EditorView, WidgetType} from "@codemirror/view";

export class HighlightWidget extends WidgetType {
	innerText: string;
	eventUUID: string;
	syncCallback: () => void;

	constructor(innerText: string, eventUUID: string, syncCallback: () => void) {
		super();
		this.innerText = innerText;
		this.eventUUID = eventUUID;
		this.syncCallback = syncCallback;
	}

	/*
	  <mark class="highlighted-text" id="highlighted-text">
	  	consectetur adipiscing elit
	  	<span class="tooltip">
        	This is a pop-up tooltip
        	<button class="tooltip-button">
        		Click Me
        	</button>
      	</span>
      </mark>

	 */
	toDOM(view: EditorView): HTMLElement {
		const mark = document.createElement("mark");
		mark.addClass("highlighted-text");
		mark.innerText = this.innerText;
		mark.id = "highlighted-text";
		const tooltip = mark.createEl("span");
		tooltip.addClass("tooltip");
		const button = tooltip.createEl("button")
		button.addClass("icon-button");
		button.innerHTML = button.innerHTML = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" version=\"1.1\" width=\"100%\" style=\"shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd\" xml:space=\"preserve\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n" +
			"<g><path style=\"opacity:0.973\" fill=\"#010101\" d=\"M 108.5,40.5 C 111.355,43.5919 112.188,47.2586 111,51.5C 109.786,53.0488 108.286,54.2155 106.5,55C 88.5,55.3333 70.5,55.6667 52.5,56C 33.8471,60.6533 21.6804,72.1533 16,90.5C 14.3446,171.79 14.0113,253.123 15,334.5C 19.0307,358.198 32.864,372.364 56.5,377C 98.5,377.333 140.5,377.667 182.5,378C 188.43,379.922 193.263,383.422 197,388.5C 212.333,409.167 227.667,429.833 243,450.5C 251.304,457.111 259.637,457.111 268,450.5C 283.333,429.833 298.667,409.167 314,388.5C 317.737,383.422 322.57,379.922 328.5,378C 341.167,377.333 353.833,377.333 366.5,378C 369.217,379.259 370.55,381.426 370.5,384.5C 370.218,387.731 368.885,390.398 366.5,392.5C 354.424,392.062 342.424,392.562 330.5,394C 312.833,417 295.167,440 277.5,463C 261.318,474.932 245.818,474.099 231,460.5C 214.774,437.884 197.94,415.718 180.5,394C 138.226,392.683 95.8925,392.016 53.5,392C 24.5161,386.18 6.51609,369.013 -0.5,340.5C -0.5,257.5 -0.5,174.5 -0.5,91.5C 6.66511,62.5041 24.9984,45.3374 54.5,40C 72.5736,39.1812 90.5736,39.3479 108.5,40.5 Z\"/></g>\n" +
			"<g><path style=\"opacity:0.974\" fill=\"#040404\" d=\"M 511.5,91.5 C 511.5,174.5 511.5,257.5 511.5,340.5C 504.484,369.013 486.484,386.18 457.5,392C 435.094,392.822 412.761,392.655 390.5,391.5C 386.196,386.534 386.529,382.034 391.5,378C 412.5,377.667 433.5,377.333 454.5,377C 478.136,372.364 491.969,358.198 496,334.5C 496.667,254.5 496.667,174.5 496,94.5C 491.233,74.1318 478.733,61.2985 458.5,56C 351.167,55.6667 243.833,55.3333 136.5,55C 131.776,52.5647 130.276,48.7314 132,43.5C 133.045,42.6266 133.878,41.6266 134.5,40.5C 241.764,39.3357 349.097,39.1691 456.5,40C 486.002,45.3374 504.335,62.5041 511.5,91.5 Z\"/></g>\n" +
			"<g><path style=\"opacity:1\" fill=\"#eeeeee\" d=\"M 108.5,40.5 C 117.167,40.5 125.833,40.5 134.5,40.5C 133.878,41.6266 133.045,42.6266 132,43.5C 130.276,48.7314 131.776,52.5647 136.5,55C 243.833,55.3333 351.167,55.6667 458.5,56C 478.733,61.2985 491.233,74.1318 496,94.5C 496.667,174.5 496.667,254.5 496,334.5C 491.969,358.198 478.136,372.364 454.5,377C 433.5,377.333 412.5,377.667 391.5,378C 386.529,382.034 386.196,386.534 390.5,391.5C 382.445,391.23 374.445,391.563 366.5,392.5C 368.885,390.398 370.218,387.731 370.5,384.5C 370.55,381.426 369.217,379.259 366.5,378C 353.833,377.333 341.167,377.333 328.5,378C 322.57,379.922 317.737,383.422 314,388.5C 298.667,409.167 283.333,429.833 268,450.5C 259.637,457.111 251.304,457.111 243,450.5C 227.667,429.833 212.333,409.167 197,388.5C 193.263,383.422 188.43,379.922 182.5,378C 140.5,377.667 98.5,377.333 56.5,377C 32.864,372.364 19.0307,358.198 15,334.5C 14.0113,253.123 14.3446,171.79 16,90.5C 21.6804,72.1533 33.8471,60.6533 52.5,56C 70.5,55.6667 88.5,55.3333 106.5,55C 108.286,54.2155 109.786,53.0488 111,51.5C 112.188,47.2586 111.355,43.5919 108.5,40.5 Z\"/></g>\n" +
			"<g><path style=\"opacity:1\" fill=\"#040404\" d=\"M 238.5,101.5 C 288.974,97.3091 325.474,117.642 348,162.5C 349.806,167.418 351.306,172.418 352.5,177.5C 382.402,186.128 398.735,205.961 401.5,237C 399.953,274.105 380.953,296.105 344.5,303C 329.837,303.5 315.17,303.667 300.5,303.5C 300.5,297.5 300.5,291.5 300.5,285.5C 314.504,285.667 328.504,285.5 342.5,285C 367.772,280.059 381.439,264.725 383.5,239C 380.983,213.817 367.316,198.817 342.5,194C 340.998,193.417 339.665,192.584 338.5,191.5C 325.278,142.392 293.278,118.892 242.5,121C 205.825,129.01 182.991,151.177 174,187.5C 173.458,194.605 172.458,201.605 171,208.5C 169.421,210.041 167.587,211.208 165.5,212C 148.373,212.146 136.206,219.979 129,235.5C 123.125,260.923 132.625,277.423 157.5,285C 174.83,285.5 192.163,285.667 209.5,285.5C 209.5,291.5 209.5,297.5 209.5,303.5C 190.83,303.667 172.164,303.5 153.5,303C 121.853,293.677 107.02,272.51 109,239.5C 114.76,214.906 129.927,199.906 154.5,194.5C 161.51,144.492 189.51,113.492 238.5,101.5 Z\"/></g>\n" +
			"<g><path style=\"opacity:1\" fill=\"#020202\" d=\"M 246.5,330.5 C 246.833,301.492 246.5,272.492 245.5,243.5C 244.893,243.624 244.56,243.957 244.5,244.5C 238.447,251.252 231.947,257.586 225,263.5C 220.495,259.661 216.328,255.495 212.5,251C 224.833,238.667 237.167,226.333 249.5,214C 252.702,212.517 256.036,212.183 259.5,213C 272.293,225.627 284.96,238.46 297.5,251.5C 293.833,255.833 289.833,259.833 285.5,263.5C 278.514,257.015 271.681,250.348 265,243.5C 264.5,272.498 264.333,301.498 264.5,330.5C 258.5,330.5 252.5,330.5 246.5,330.5 Z\"/></g>\n" +
			"<g><path style=\"opacity:1\" fill=\"#7e7e7e\" d=\"M 244.5,244.5 C 244.56,243.957 244.893,243.624 245.5,243.5C 246.5,272.492 246.833,301.492 246.5,330.5C 245.833,301.833 245.167,273.167 244.5,244.5 Z\"/></g>\n" +
			"</svg>"

		/*
		button.innerHTML = "<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\n" +
			"\t width=\"100%\" viewBox=\"0 0 512 512\" enable-background=\"new 0 0 512 512\" xml:space=\"preserve\">\n" +
			"<path fill=\"#000000\" opacity=\"1.000000\" stroke=\"none\" \n" +
			"\td=\"\n" +
			"M1.000000,297.468658 \n" +
			"\tC3.209013,293.363098 3.219604,289.074127 4.481982,285.140411 \n" +
			"\tC13.479895,257.101532 31.324623,237.174133 58.254837,225.231491 \n" +
			"\tC64.070724,222.652344 69.953300,220.490799 76.217422,219.535980 \n" +
			"\tC81.313484,218.759201 81.165833,214.631851 81.531563,211.226624 \n" +
			"\tC85.274132,176.380493 98.695709,145.764816 120.992760,118.808037 \n" +
			"\tC141.859756,93.580185 167.879150,75.753128 198.539261,64.879570 \n" +
			"\tC222.298447,56.453419 247.110046,54.070065 272.142334,55.832714 \n" +
			"\tC292.950897,57.297943 312.957520,62.844120 331.840118,71.712372 \n" +
			"\tC356.534302,83.310020 377.467529,99.697937 394.714874,121.089035 \n" +
			"\tC409.884949,139.903748 420.302094,160.888535 426.960175,183.906876 \n" +
			"\tC427.928284,187.253815 429.815979,188.826828 432.966156,189.709946 \n" +
			"\tC450.749451,194.695267 466.412231,203.659073 479.564789,216.480957 \n" +
			"\tC498.078278,234.528992 509.217407,256.559570 512.886963,282.643188 \n" +
			"\tC513.000000,292.687561 513.000000,302.375122 513.000000,312.531342 \n" +
			"\tC511.269470,324.363647 508.106384,335.295349 503.352478,345.779572 \n" +
			"\tC499.213684,354.907135 493.619019,363.059387 487.334534,370.815308 \n" +
			"\tC478.867828,381.264465 468.477325,389.388550 456.945496,396.082489 \n" +
			"\tC445.222687,402.887207 432.633179,407.823090 419.160065,409.220490 \n" +
			"\tC393.113434,411.921967 366.936218,409.793793 340.822815,410.381989 \n" +
			"\tC337.902405,410.447754 336.598328,409.348724 336.638031,406.301178 \n" +
			"\tC336.746490,397.971771 336.834076,389.635559 336.602295,381.311127 \n" +
			"\tC336.492950,377.384155 338.211090,376.588745 341.690491,376.605865 \n" +
			"\tC363.016998,376.710571 384.354736,377.065918 405.668152,376.525421 \n" +
			"\tC423.359070,376.076874 438.714325,369.101410 452.236938,357.629700 \n" +
			"\tC467.243347,344.899261 475.987183,328.730621 478.981842,309.580872 \n" +
			"\tC481.304932,294.725586 479.534424,280.154358 473.189117,266.277863 \n" +
			"\tC461.374115,240.439819 441.269928,225.295105 413.561676,220.207260 \n" +
			"\tC403.364166,218.334793 398.668793,211.913910 396.662201,202.537476 \n" +
			"\tC392.026215,180.874084 382.590057,161.446060 368.677612,144.300873 \n" +
			"\tC350.997559,122.512596 328.810303,107.163322 302.101562,98.179230 \n" +
			"\tC287.638092,93.314095 272.753296,90.745728 257.727539,90.706635 \n" +
			"\tC241.682800,90.664894 225.702393,93.133530 210.480896,98.796318 \n" +
			"\tC195.298767,104.444450 181.178223,111.989006 168.467682,122.185196 \n" +
			"\tC150.271927,136.781494 136.418732,154.539993 126.932678,175.919861 \n" +
			"\tC118.590111,194.722534 114.506584,214.265625 114.292778,234.757278 \n" +
			"\tC114.209923,242.697403 108.007332,249.406815 100.166733,250.340897 \n" +
			"\tC88.984482,251.673111 77.791603,252.707321 67.703438,258.527191 \n" +
			"\tC49.837902,268.833832 38.744690,283.728027 35.253208,304.294678 \n" +
			"\tC32.291355,321.741547 36.455406,337.544830 46.892075,351.234467 \n" +
			"\tC59.125435,367.280823 75.416237,376.709442 96.292244,376.668274 \n" +
			"\tC121.618027,376.618317 146.945038,376.775421 172.268951,376.551910 \n" +
			"\tC177.124222,376.509064 178.653122,377.971588 178.427841,382.771362 \n" +
			"\tC178.068924,390.418945 178.216721,398.098145 178.383759,405.758911 \n" +
			"\tC178.458466,409.185730 177.269257,410.441223 173.770660,410.429260 \n" +
			"\tC144.946167,410.330597 116.092842,411.154358 87.305817,410.110748 \n" +
			"\tC66.114014,409.342468 47.626469,400.140564 31.886955,385.918610 \n" +
			"\tC16.520031,372.033234 6.605462,354.918976 2.451810,334.549286 \n" +
			"\tC2.362627,334.111877 1.895635,333.751556 1.302443,333.177612 \n" +
			"\tC1.000000,321.312439 1.000000,309.624878 1.000000,297.468658 \n" +
			"z\"/>\n" +
			"<path fill=\"#000000\" opacity=\"1.000000\" stroke=\"none\" \n" +
			"\td=\"\n" +
			"M204.822571,341.726440 \n" +
			"\tC196.675980,335.593445 190.175476,327.965973 183.013260,321.022827 \n" +
			"\tC180.189926,318.285858 182.496155,316.274170 184.428223,314.342194 \n" +
			"\tC201.278275,297.492889 218.121872,280.637177 234.974930,263.790924 \n" +
			"\tC238.038849,260.728241 241.035721,257.588348 244.239273,254.677475 \n" +
			"\tC252.745865,246.948059 262.570679,247.179855 270.711090,255.325150 \n" +
			"\tC290.619904,275.246002 310.430817,295.264984 330.402100,315.122864 \n" +
			"\tC333.309235,318.013489 333.445587,319.920715 330.367432,322.774384 \n" +
			"\tC324.504913,328.209290 318.864532,333.901245 313.387360,339.726685 \n" +
			"\tC310.790344,342.488800 309.067719,342.301300 306.508606,339.684845 \n" +
			"\tC297.536346,330.511627 288.382263,321.515533 279.241913,312.508301 \n" +
			"\tC278.006989,311.291382 277.051880,309.535797 274.897614,309.417084 \n" +
			"\tC273.862946,311.152893 274.377136,313.015747 274.375763,314.773804 \n" +
			"\tC274.340179,360.439819 274.350525,406.105865 274.341400,451.771912 \n" +
			"\tC274.340088,458.362274 274.312958,458.370422 267.757385,458.379913 \n" +
			"\tC260.757477,458.390045 253.743942,458.116486 246.762360,458.474274 \n" +
			"\tC241.923401,458.722290 240.542419,457.059082 240.559296,452.251190 \n" +
			"\tC240.720749,406.252380 240.660828,360.252777 240.627060,314.253418 \n" +
			"\tC240.625641,312.316681 241.085419,310.296570 239.715988,307.554169 \n" +
			"\tC228.021545,319.071014 216.586044,330.332855 204.822571,341.726440 \n" +
			"z\"/>\n" +
			"</svg>";
		*/

		button.onClickEvent((mouseEvent) => {
			this.syncCallback.call(this);
		})
		/*
		const mark = document.createElement("mark");
		mark.addClass("highlighted-text");
		mark.setAttribute("data-tooltip", "This is a pop-up tooltip")
		mark.innerText = this.innerText;
		/*
		const button = mark.createEl("button");
		button.addClass("tooltip-button");
		 */
		return mark;

	}
}
