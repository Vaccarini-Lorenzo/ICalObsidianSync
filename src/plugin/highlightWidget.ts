import {EditorView, WidgetType} from "@codemirror/view";

export class HighlightWidget extends WidgetType {
	sentenceValue: string;
	eventDetails: string;
	syncCallback: () => void;
	markClass: string;

	constructor(sentenceValue: string, eventDetails: string, syncCallback: () => void, firstLoad: boolean) {
		super();
		this.sentenceValue = sentenceValue;
		this.eventDetails = eventDetails;
		this.syncCallback = syncCallback;
		this.markClass = "highlighted-text-static";
		if(firstLoad) this.markClass = "highlighted-text-dynamic";
	}

	toDOM(view: EditorView): HTMLElement {
		const navUl = document.createElement("ul");
		navUl.addClass("navUL");
		const mark = navUl.createEl("span");
		mark.addClass(this.markClass);
		mark.innerText = this.sentenceValue;
		const bubble = mark.createEl("div");
		bubble.addClass("bubblePosition");
		bubble.addClass("hoverBubble");
		bubble.innerHTML = this.eventDetails;
		const row = bubble.createEl("div");
		row.addClass("row");
		const buttonSync = row.createEl("button")
		buttonSync.addClass("icon-button");
		buttonSync.innerHTML = "<svg version=\"1.1\" id=\"Layer_1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" x=\"0px\" y=\"0px\"\n" +
			"\t width=\"100%\" viewBox=\"0 0 512 512\" enable-background=\"new 0 0 512 512\" xml:space=\"preserve\">\n" +
			"<path fill=\"#000000\" opacity=\"1.000000\" stroke=\"none\" \n" +
			"\td=\"\n" +
			"M1.000000,297.468658 \n" +
			"\tC3.209013,293.363098 3.219604,289.074127 4.481982,285.140411 \n" +
			"\tC13.479895,257.101532 31.324623,237.174133 58.254837,225.231491 \n" +
			"\tC64.070724,222.652344 69.953300,220.490799 76.217422,219.535980 \n" +
			"\tC81.313484,218.759201 81.165833,214.631851 81.531563,211.226624 \n" +
			"\tC85.274132,176.380493 98.695709,145.764816 120.992760,118.808037 \n" +
			"\tC141.859756,93.580185 167.879150,75.753128 198.539261,64.879570 \n" +
			"\tC222.298447,56.453419 247.110046,54.070065 272.142334,55.832714 \n" +
			"\tC292.950897,57.297943 312.957520,62.844120 331.840118,71.712372 \n" +
			"\tC356.534302,83.310020 377.467529,99.697937 394.714874,121.089035 \n" +
			"\tC409.884949,139.903748 420.302094,160.888535 426.960175,183.906876 \n" +
			"\tC427.928284,187.253815 429.815979,188.826828 432.966156,189.709946 \n" +
			"\tC450.749451,194.695267 466.412231,203.659073 479.564789,216.480957 \n" +
			"\tC498.078278,234.528992 509.217407,256.559570 512.886963,282.643188 \n" +
			"\tC513.000000,292.687561 513.000000,302.375122 513.000000,312.531342 \n" +
			"\tC511.269470,324.363647 508.106384,335.295349 503.352478,345.779572 \n" +
			"\tC499.213684,354.907135 493.619019,363.059387 487.334534,370.815308 \n" +
			"\tC478.867828,381.264465 468.477325,389.388550 456.945496,396.082489 \n" +
			"\tC445.222687,402.887207 432.633179,407.823090 419.160065,409.220490 \n" +
			"\tC393.113434,411.921967 366.936218,409.793793 340.822815,410.381989 \n" +
			"\tC337.902405,410.447754 336.598328,409.348724 336.638031,406.301178 \n" +
			"\tC336.746490,397.971771 336.834076,389.635559 336.602295,381.311127 \n" +
			"\tC336.492950,377.384155 338.211090,376.588745 341.690491,376.605865 \n" +
			"\tC363.016998,376.710571 384.354736,377.065918 405.668152,376.525421 \n" +
			"\tC423.359070,376.076874 438.714325,369.101410 452.236938,357.629700 \n" +
			"\tC467.243347,344.899261 475.987183,328.730621 478.981842,309.580872 \n" +
			"\tC481.304932,294.725586 479.534424,280.154358 473.189117,266.277863 \n" +
			"\tC461.374115,240.439819 441.269928,225.295105 413.561676,220.207260 \n" +
			"\tC403.364166,218.334793 398.668793,211.913910 396.662201,202.537476 \n" +
			"\tC392.026215,180.874084 382.590057,161.446060 368.677612,144.300873 \n" +
			"\tC350.997559,122.512596 328.810303,107.163322 302.101562,98.179230 \n" +
			"\tC287.638092,93.314095 272.753296,90.745728 257.727539,90.706635 \n" +
			"\tC241.682800,90.664894 225.702393,93.133530 210.480896,98.796318 \n" +
			"\tC195.298767,104.444450 181.178223,111.989006 168.467682,122.185196 \n" +
			"\tC150.271927,136.781494 136.418732,154.539993 126.932678,175.919861 \n" +
			"\tC118.590111,194.722534 114.506584,214.265625 114.292778,234.757278 \n" +
			"\tC114.209923,242.697403 108.007332,249.406815 100.166733,250.340897 \n" +
			"\tC88.984482,251.673111 77.791603,252.707321 67.703438,258.527191 \n" +
			"\tC49.837902,268.833832 38.744690,283.728027 35.253208,304.294678 \n" +
			"\tC32.291355,321.741547 36.455406,337.544830 46.892075,351.234467 \n" +
			"\tC59.125435,367.280823 75.416237,376.709442 96.292244,376.668274 \n" +
			"\tC121.618027,376.618317 146.945038,376.775421 172.268951,376.551910 \n" +
			"\tC177.124222,376.509064 178.653122,377.971588 178.427841,382.771362 \n" +
			"\tC178.068924,390.418945 178.216721,398.098145 178.383759,405.758911 \n" +
			"\tC178.458466,409.185730 177.269257,410.441223 173.770660,410.429260 \n" +
			"\tC144.946167,410.330597 116.092842,411.154358 87.305817,410.110748 \n" +
			"\tC66.114014,409.342468 47.626469,400.140564 31.886955,385.918610 \n" +
			"\tC16.520031,372.033234 6.605462,354.918976 2.451810,334.549286 \n" +
			"\tC2.362627,334.111877 1.895635,333.751556 1.302443,333.177612 \n" +
			"\tC1.000000,321.312439 1.000000,309.624878 1.000000,297.468658 \n" +
			"z\"/>\n" +
			"<path fill=\"#000000\" opacity=\"1.000000\" stroke=\"none\" \n" +
			"\td=\"\n" +
			"M204.822571,341.726440 \n" +
			"\tC196.675980,335.593445 190.175476,327.965973 183.013260,321.022827 \n" +
			"\tC180.189926,318.285858 182.496155,316.274170 184.428223,314.342194 \n" +
			"\tC201.278275,297.492889 218.121872,280.637177 234.974930,263.790924 \n" +
			"\tC238.038849,260.728241 241.035721,257.588348 244.239273,254.677475 \n" +
			"\tC252.745865,246.948059 262.570679,247.179855 270.711090,255.325150 \n" +
			"\tC290.619904,275.246002 310.430817,295.264984 330.402100,315.122864 \n" +
			"\tC333.309235,318.013489 333.445587,319.920715 330.367432,322.774384 \n" +
			"\tC324.504913,328.209290 318.864532,333.901245 313.387360,339.726685 \n" +
			"\tC310.790344,342.488800 309.067719,342.301300 306.508606,339.684845 \n" +
			"\tC297.536346,330.511627 288.382263,321.515533 279.241913,312.508301 \n" +
			"\tC278.006989,311.291382 277.051880,309.535797 274.897614,309.417084 \n" +
			"\tC273.862946,311.152893 274.377136,313.015747 274.375763,314.773804 \n" +
			"\tC274.340179,360.439819 274.350525,406.105865 274.341400,451.771912 \n" +
			"\tC274.340088,458.362274 274.312958,458.370422 267.757385,458.379913 \n" +
			"\tC260.757477,458.390045 253.743942,458.116486 246.762360,458.474274 \n" +
			"\tC241.923401,458.722290 240.542419,457.059082 240.559296,452.251190 \n" +
			"\tC240.720749,406.252380 240.660828,360.252777 240.627060,314.253418 \n" +
			"\tC240.625641,312.316681 241.085419,310.296570 239.715988,307.554169 \n" +
			"\tC228.021545,319.071014 216.586044,330.332855 204.822571,341.726440 \n" +
			"z\"/>\n" +
			"</svg>"
		buttonSync.onClickEvent((mouseEvent) => {
			this.syncCallback.call(this);
		})
		const buttonNoSync = row.createEl("button")
		buttonNoSync.addClass("icon-button");
		buttonNoSync.innerHTML = "<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\" version=\"1.1\" width=\"100%\" style=\"shape-rendering:geometricPrecision; text-rendering:geometricPrecision; image-rendering:optimizeQuality; fill-rule:evenodd; clip-rule:evenodd\" xml:space=\"preserve\" >\n" +
			"<g transform=\"translate(0.000000,512.000000) scale(0.100000,-0.100000)\"\n" +
			"fill=\"#000000\" stroke=\"none\">\n" +
			"<path d=\"M555 5106 c-106 -26 -143 -52 -316 -225 -184 -184 -209 -222 -231\n" +
			"-350 -9 -56 -9 -86 0 -141 26 -151 -7 -114 890 -1012 l817 -818 -821 -822\n" +
			"c-772 -774 -822 -827 -848 -887 -58 -132 -58 -264 1 -389 37 -82 333 -378 415\n" +
			"-415 85 -40 182 -54 269 -39 149 26 105 -13 1006 886 l823 821 817 -817 c899\n" +
			"-897 862 -864 1013 -890 86 -15 184 -1 268 39 82 37 378 333 415 415 40 84 54\n" +
			"182 39 268 -26 151 7 114 -890 1012 l-817 818 817 818 c897 898 864 861 890\n" +
			"1012 15 86 1 184 -39 268 -37 81 -332 376 -415 415 -124 59 -257 59 -389 1\n" +
			"-60 -26 -113 -76 -887 -848 l-822 -821 -823 821 c-702 701 -830 824 -877 846\n" +
			"-101 47 -205 59 -305 34z\"/>\n" +
			"</g>\n" +
			"</svg>\n"

		return navUl;

	}
}
